module.exports=function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=4)}([function(e,t){e.exports=require("boundless-utils-omit-keys")},function(e,t){e.exports=require("boundless-utils-uuid")},function(e,t){e.exports=require("react")},function(e,t){e.exports=require("react-dom")},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),c=n.n(a),u=n(3),l=(n.n(u),n(0)),d=n.n(l),p=n(1),h=n.n(p),f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},v=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),m="data-focus-index",y="data-focus-skip",O=function(e){function t(){var e,r,s,c;o(this,t);for(var l=arguments.length,d=Array(l),p=0;p<l;p++)d[p]=arguments[p];return r=s=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(d))),s.state={activeChildIndex:s.props.defaultActiveChildIndex,children:[]},s.handleKeyDown=function(e){switch(e.key){case"ArrowUp":s.props.mode!==t.mode.VERTICAL&&s.props.mode!==t.mode.BOTH||(e.preventDefault(),s.moveFocus(-1));break;case"ArrowLeft":s.props.mode!==t.mode.HORIZONTAL&&s.props.mode!==t.mode.BOTH||(e.preventDefault(),s.moveFocus(-1));break;case"ArrowDown":s.props.mode!==t.mode.VERTICAL&&s.props.mode!==t.mode.BOTH||(e.preventDefault(),s.moveFocus(1));break;case"ArrowRight":s.props.mode!==t.mode.HORIZONTAL&&s.props.mode!==t.mode.BOTH||(e.preventDefault(),s.moveFocus(1))}s.props.onKeyDown&&s.props.onKeyDown(e)},s.handleFocus=function(e){if(e.target.hasAttribute(m)){var t=parseInt(e.target.getAttribute(m),10),n=a.Children.toArray(s.state.children)[t];s.setState({activeChildIndex:t}),n.props.onFocus&&n.props.onFocus(e)}},s.persistWrapperElementReference=function(e){s.$wrapper=e instanceof HTMLElement?e:n.i(u.findDOMNode)(e)},c=r,i(s,c)}return s(t,e),v(t,[{key:"getFilteredChildren",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;return a.Children.toArray(e.children).filter(Boolean)}},{key:"setActiveChildIndex",value:function(){if(0!==this.state.activeChildIndex){var e=a.Children.count(this.state.children);0===e?this.setState({activeChildIndex:0}):this.state.activeChildIndex>=e&&this.setState({activeChildIndex:e-1})}}},{key:"componentWillMount",value:function(){this.setState({children:this.getFilteredChildren()})}},{key:"componentWillReceiveProps",value:function(e){return e.children!==this.props.children?this.setState({children:this.getFilteredChildren(e)},this.setActiveChildIndex):void this.setActiveChildIndex()}},{key:"componentDidUpdate",value:function(e,t){this.state.activeChildIndex!==t.activeChildIndex&&this.setFocus(this.state.activeChildIndex)}},{key:"setFocus",value:function(e){var t=this.$wrapper.children[e];t&&t.hasAttribute(y)?this.moveFocus(t.compareDocumentPosition(document.activeElement)&Node.DOCUMENT_POSITION_FOLLOWING?-1:1):t&&document.activeElement!==t&&t.focus()}},{key:"moveFocus",value:function(e){var t=this.state.children?a.Children.count(this.state.children):0,n=this.state.activeChildIndex+e;n>=t?n=0:n<0&&(n=t-1),this.setState({activeChildIndex:n})}},{key:"renderChildren",value:function(){var e=this;return a.Children.map(this.state.children,function(t,n){var o;return c.a.cloneElement(t,(o={},r(o,m,n),r(o,y,parseInt(t.props.tabIndex,10)===-1||void 0),r(o,"key",t.key||n),r(o,"tabIndex",e.state.activeChildIndex===n?0:-1),o))})}},{key:"render",value:function(){return c.a.createElement(this.props.component,f({},d()(this.props,t.internalKeys),{ref:this.persistWrapperElementReference,onFocus:this.handleFocus,onKeyDown:this.handleKeyDown}),this.renderChildren())}}]),t}(c.a.PureComponent);O.mode={HORIZONTAL:h()(),VERTICAL:h()(),BOTH:h()()},O.propTypes={"*":a.PropTypes.any,component:a.PropTypes.oneOfType([a.PropTypes.string,a.PropTypes.func]),defaultActiveChildIndex:a.PropTypes.number,mode:a.PropTypes.oneOf([O.mode.BOTH,O.mode.HORIZONTAL,O.mode.VERTICAL])},O.defaultProps={component:"div",defaultActiveChildIndex:0,mode:O.mode.BOTH,onKeyDown:function(){}},O.internalKeys=Object.keys(O.defaultProps),t.default=O}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vaW5kZXguanMiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svYm9vdHN0cmFwIGI2OWUyZWY1YjU5MjY0ZjAyNjM5Iiwid2VicGFjazovLy9leHRlcm5hbCB7XCJjb21tb25qczJcIjpcImJvdW5kbGVzcy11dGlscy1vbWl0LWtleXNcIn0iLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIHtcImNvbW1vbmpzMlwiOlwiYm91bmRsZXNzLXV0aWxzLXV1aWRcIn0iLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIHtcImNvbW1vbmpzMlwiOlwicmVhY3RcIn0iLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIHtcImNvbW1vbmpzMlwiOlwicmVhY3QtZG9tXCJ9Iiwid2VicGFjazovLy8uL3BhY2thZ2VzL2JvdW5kbGVzcy1hcnJvdy1rZXktbmF2aWdhdGlvbi9pbmRleC5qcyJdLCJuYW1lcyI6WyJtb2R1bGUiLCJleHBvcnRzIiwibW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImluc3RhbGxlZE1vZHVsZXMiLCJpIiwibCIsImNhbGwiLCJtIiwiYyIsInZhbHVlIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwiZ2V0IiwibiIsIl9fZXNNb2R1bGUiLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJyZXF1aXJlIiwiX193ZWJwYWNrX2V4cG9ydHNfXyIsIl9kZWZpbmVQcm9wZXJ0eSIsIm9iaiIsImtleSIsIndyaXRhYmxlIiwiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJDb25zdHJ1Y3RvciIsIlR5cGVFcnJvciIsIl9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIiwic2VsZiIsIlJlZmVyZW5jZUVycm9yIiwiX2luaGVyaXRzIiwic3ViQ2xhc3MiLCJzdXBlckNsYXNzIiwiY3JlYXRlIiwiY29uc3RydWN0b3IiLCJzZXRQcm90b3R5cGVPZiIsIl9fcHJvdG9fXyIsIl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9yZWFjdF9fIiwiX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX3JlYWN0X19fZGVmYXVsdCIsIl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9yZWFjdF9kb21fXyIsIl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9ib3VuZGxlc3NfdXRpbHNfb21pdF9rZXlzX18iLCJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfYm91bmRsZXNzX3V0aWxzX29taXRfa2V5c19fX2RlZmF1bHQiLCJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzNfYm91bmRsZXNzX3V0aWxzX3V1aWRfXyIsIl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfM19ib3VuZGxlc3NfdXRpbHNfdXVpZF9fX2RlZmF1bHQiLCJfZXh0ZW5kcyIsImFzc2lnbiIsInRhcmdldCIsImFyZ3VtZW50cyIsImxlbmd0aCIsInNvdXJjZSIsIl9jcmVhdGVDbGFzcyIsImRlZmluZVByb3BlcnRpZXMiLCJwcm9wcyIsImRlc2NyaXB0b3IiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJEQVRBX0FUVFJJQlVURV9JTkRFWCIsIkRBVEFfQVRUUklCVVRFX1NLSVAiLCJBcnJvd0tleU5hdmlnYXRpb24iLCJfUmVhY3QkUHVyZUNvbXBvbmVudCIsIl9yZWYiLCJfdGVtcCIsIl90aGlzIiwiX3JldCIsInRoaXMiLCJfbGVuIiwiYXJncyIsIkFycmF5IiwiX2tleSIsImdldFByb3RvdHlwZU9mIiwiYXBwbHkiLCJjb25jYXQiLCJzdGF0ZSIsImFjdGl2ZUNoaWxkSW5kZXgiLCJkZWZhdWx0QWN0aXZlQ2hpbGRJbmRleCIsImNoaWxkcmVuIiwiaGFuZGxlS2V5RG93biIsImV2ZW50IiwibW9kZSIsIlZFUlRJQ0FMIiwiQk9USCIsInByZXZlbnREZWZhdWx0IiwibW92ZUZvY3VzIiwiSE9SSVpPTlRBTCIsIm9uS2V5RG93biIsImhhbmRsZUZvY3VzIiwiaGFzQXR0cmlidXRlIiwiaW5kZXgiLCJwYXJzZUludCIsImdldEF0dHJpYnV0ZSIsImNoaWxkIiwidG9BcnJheSIsInNldFN0YXRlIiwib25Gb2N1cyIsInBlcnNpc3RXcmFwcGVyRWxlbWVudFJlZmVyZW5jZSIsInVua25vd25UeXBlIiwiJHdyYXBwZXIiLCJIVE1MRWxlbWVudCIsInVuZGVmaW5lZCIsImZpbHRlciIsIkJvb2xlYW4iLCJudW1DaGlsZHJlbiIsImNvdW50IiwiZ2V0RmlsdGVyZWRDaGlsZHJlbiIsIm5leHRQcm9wcyIsInNldEFjdGl2ZUNoaWxkSW5kZXgiLCJwcmV2UHJvcHMiLCJwcmV2U3RhdGUiLCJzZXRGb2N1cyIsImNoaWxkTm9kZSIsImNvbXBhcmVEb2N1bWVudFBvc2l0aW9uIiwiZG9jdW1lbnQiLCJhY3RpdmVFbGVtZW50IiwiTm9kZSIsIkRPQ1VNRU5UX1BPU0lUSU9OX0ZPTExPV0lORyIsImZvY3VzIiwiZGVsdGEiLCJuZXh0SW5kZXgiLCJfdGhpczIiLCJtYXAiLCJfUmVhY3QkY2xvbmVFbGVtZW50IiwiYSIsImNsb25lRWxlbWVudCIsInRhYkluZGV4IiwiY3JlYXRlRWxlbWVudCIsImNvbXBvbmVudCIsImludGVybmFsS2V5cyIsInJlZiIsInJlbmRlckNoaWxkcmVuIiwiUHVyZUNvbXBvbmVudCIsInByb3BUeXBlcyIsIioiLCJhbnkiLCJvbmVPZlR5cGUiLCJzdHJpbmciLCJmdW5jIiwibnVtYmVyIiwib25lT2YiLCJkZWZhdWx0UHJvcHMiLCJrZXlzIl0sIm1hcHBpbmdzIjoiQUFBQUEsT0FBT0MsUUFDRSxTQUFVQyxHQ0duQixRQUFBQyxHQUFBQyxHQUdBLEdBQUFDLEVBQUFELEdBQ0EsTUFBQUMsR0FBQUQsR0FBQUgsT0FHQSxJQUFBRCxHQUFBSyxFQUFBRCxJQUNBRSxFQUFBRixFQUNBRyxHQUFBLEVBQ0FOLFdBVUEsT0FOQUMsR0FBQUUsR0FBQUksS0FBQVIsRUFBQUMsUUFBQUQsSUFBQUMsUUFBQUUsR0FHQUgsRUFBQU8s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QXlCckMsRUFBQSxVQUFVbUcsT0FhbkMxRCxLQUFNekMsRUFBQSxVQUFVb0csT0FDWi9FLEVBQW1Cb0IsS0FBS0UsS0FDeEJ0QixFQUFtQm9CLEtBQUtLLFdBQ3hCekIsRUFBbUJvQixLQUFLQyxZQXhDZnJCLEVBNENWZ0YsY0FDSGIsVUFBVyxNQUNYbkQsd0JBQXlCLEVBQ3pCSSxLQUFNcEIsRUFBbUJvQixLQUFLRSxLQUM5QkksVUFBVyxjQWhERTFCLEVBbURWb0UsYUFBZTFILE9BQU91SSxLQUFLakYsRUFBbUJnRixjTjBDeWhQeEgsRUFBNkIsUU03RjFsUHdDIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPVxuLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcFxuLyoqKioqKi8gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuLyoqKioqKi8gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuLyoqKioqKi8gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0aTogbW9kdWxlSWQsXG4vKioqKioqLyBcdFx0XHRsOiBmYWxzZSxcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9XG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBpZGVudGl0eSBmdW5jdGlvbiBmb3IgY2FsbGluZyBoYXJtb255IGltcG9ydHMgd2l0aCB0aGUgY29ycmVjdCBjb250ZXh0XG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uaSA9IGZ1bmN0aW9uKHZhbHVlKSB7IHJldHVybiB2YWx1ZTsgfTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbi8qKioqKiovIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4vKioqKioqLyBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuLyoqKioqKi8gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuLyoqKioqKi8gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuLyoqKioqKi8gXHRcdFx0XHRnZXQ6IGdldHRlclxuLyoqKioqKi8gXHRcdFx0fSk7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4vKioqKioqLyBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4vKioqKioqLyBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuLyoqKioqKi8gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbi8qKioqKiovIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4vKioqKioqLyBcdFx0cmV0dXJuIGdldHRlcjtcbi8qKioqKiovIFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vKioqKioqLyBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDQpO1xuLyoqKioqKi8gfSlcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKioqKioqLyAoW1xuLyogMCAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJib3VuZGxlc3MtdXRpbHMtb21pdC1rZXlzXCIpO1xuXG4vKioqLyB9KSxcbi8qIDEgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiYm91bmRsZXNzLXV0aWxzLXV1aWRcIik7XG5cbi8qKiovIH0pLFxuLyogMiAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJyZWFjdFwiKTtcblxuLyoqKi8gfSksXG4vKiAzICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cbm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInJlYWN0LWRvbVwiKTtcblxuLyoqKi8gfSksXG4vKiA0ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBfX3dlYnBhY2tfZXhwb3J0c19fLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KF9fd2VicGFja19leHBvcnRzX18sIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuLyogaGFybW9ueSBpbXBvcnQgKi8gdmFyIF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9yZWFjdF9fID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcbi8qIGhhcm1vbnkgaW1wb3J0ICovIHZhciBfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfcmVhY3RfX19kZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXy5uKF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9yZWFjdF9fKTtcbi8qIGhhcm1vbnkgaW1wb3J0ICovIHZhciBfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfcmVhY3RfZG9tX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpO1xuLyogaGFybW9ueSBpbXBvcnQgKi8gdmFyIF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9yZWFjdF9kb21fX19kZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXy5uKF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9yZWFjdF9kb21fXyk7XG4vKiBoYXJtb255IGltcG9ydCAqLyB2YXIgX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX2JvdW5kbGVzc191dGlsc19vbWl0X2tleXNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oMCk7XG4vKiBoYXJtb255IGltcG9ydCAqLyB2YXIgX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX2JvdW5kbGVzc191dGlsc19vbWl0X2tleXNfX19kZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXy5uKF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9ib3VuZGxlc3NfdXRpbHNfb21pdF9rZXlzX18pO1xuLyogaGFybW9ueSBpbXBvcnQgKi8gdmFyIF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfM19ib3VuZGxlc3NfdXRpbHNfdXVpZF9fID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTtcbi8qIGhhcm1vbnkgaW1wb3J0ICovIHZhciBfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzNfYm91bmRsZXNzX3V0aWxzX3V1aWRfX19kZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXy5uKF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfM19ib3VuZGxlc3NfdXRpbHNfdXVpZF9fKTtcbnZhciBfZXh0ZW5kcz1PYmplY3QuYXNzaWdufHxmdW5jdGlvbih0YXJnZXQpe2Zvcih2YXIgaT0xO2k8YXJndW1lbnRzLmxlbmd0aDtpKyspe3ZhciBzb3VyY2U9YXJndW1lbnRzW2ldO2Zvcih2YXIga2V5IGluIHNvdXJjZSl7aWYoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSxrZXkpKXt0YXJnZXRba2V5XT1zb3VyY2Vba2V5XTt9fX1yZXR1cm4gdGFyZ2V0O307dmFyIF9jcmVhdGVDbGFzcz1mdW5jdGlvbigpe2Z1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LHByb3BzKXtmb3IodmFyIGk9MDtpPHByb3BzLmxlbmd0aDtpKyspe3ZhciBkZXNjcmlwdG9yPXByb3BzW2ldO2Rlc2NyaXB0b3IuZW51bWVyYWJsZT1kZXNjcmlwdG9yLmVudW1lcmFibGV8fGZhbHNlO2Rlc2NyaXB0b3IuY29uZmlndXJhYmxlPXRydWU7aWYoXCJ2YWx1ZVwiaW4gZGVzY3JpcHRvcilkZXNjcmlwdG9yLndyaXRhYmxlPXRydWU7T2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCxkZXNjcmlwdG9yLmtleSxkZXNjcmlwdG9yKTt9fXJldHVybiBmdW5jdGlvbihDb25zdHJ1Y3Rvcixwcm90b1Byb3BzLHN0YXRpY1Byb3BzKXtpZihwcm90b1Byb3BzKWRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLHByb3RvUHJvcHMpO2lmKHN0YXRpY1Byb3BzKWRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3Isc3RhdGljUHJvcHMpO3JldHVybiBDb25zdHJ1Y3Rvcjt9O30oKTtmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLGtleSx2YWx1ZSl7aWYoa2V5IGluIG9iail7T2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaixrZXkse3ZhbHVlOnZhbHVlLGVudW1lcmFibGU6dHJ1ZSxjb25maWd1cmFibGU6dHJ1ZSx3cml0YWJsZTp0cnVlfSk7fWVsc2V7b2JqW2tleV09dmFsdWU7fXJldHVybiBvYmo7fWZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSxDb25zdHJ1Y3Rvcil7aWYoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSl7dGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTt9fWZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsY2FsbCl7aWYoIXNlbGYpe3Rocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTt9cmV0dXJuIGNhbGwmJih0eXBlb2YgY2FsbD09PVwib2JqZWN0XCJ8fHR5cGVvZiBjYWxsPT09XCJmdW5jdGlvblwiKT9jYWxsOnNlbGY7fWZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcyxzdXBlckNsYXNzKXtpZih0eXBlb2Ygc3VwZXJDbGFzcyE9PVwiZnVuY3Rpb25cIiYmc3VwZXJDbGFzcyE9PW51bGwpe3Rocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiK3R5cGVvZiBzdXBlckNsYXNzKTt9c3ViQ2xhc3MucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyYmc3VwZXJDbGFzcy5wcm90b3R5cGUse2NvbnN0cnVjdG9yOnt2YWx1ZTpzdWJDbGFzcyxlbnVtZXJhYmxlOmZhbHNlLHdyaXRhYmxlOnRydWUsY29uZmlndXJhYmxlOnRydWV9fSk7aWYoc3VwZXJDbGFzcylPYmplY3Quc2V0UHJvdG90eXBlT2Y/T2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLHN1cGVyQ2xhc3MpOnN1YkNsYXNzLl9fcHJvdG9fXz1zdXBlckNsYXNzO312YXIgREFUQV9BVFRSSUJVVEVfSU5ERVg9J2RhdGEtZm9jdXMtaW5kZXgnO3ZhciBEQVRBX0FUVFJJQlVURV9TS0lQPSdkYXRhLWZvY3VzLXNraXAnO3ZhciBBcnJvd0tleU5hdmlnYXRpb249ZnVuY3Rpb24oX1JlYWN0JFB1cmVDb21wb25lbnQpe19pbmhlcml0cyhBcnJvd0tleU5hdmlnYXRpb24sX1JlYWN0JFB1cmVDb21wb25lbnQpO2Z1bmN0aW9uIEFycm93S2V5TmF2aWdhdGlvbigpe3ZhciBfcmVmO3ZhciBfdGVtcCxfdGhpcyxfcmV0O19jbGFzc0NhbGxDaGVjayh0aGlzLEFycm93S2V5TmF2aWdhdGlvbik7Zm9yKHZhciBfbGVuPWFyZ3VtZW50cy5sZW5ndGgsYXJncz1BcnJheShfbGVuKSxfa2V5PTA7X2tleTxfbGVuO19rZXkrKyl7YXJnc1tfa2V5XT1hcmd1bWVudHNbX2tleV07fXJldHVybiBfcmV0PShfdGVtcD0oX3RoaXM9X3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywoX3JlZj1BcnJvd0tleU5hdmlnYXRpb24uX19wcm90b19ffHxPYmplY3QuZ2V0UHJvdG90eXBlT2YoQXJyb3dLZXlOYXZpZ2F0aW9uKSkuY2FsbC5hcHBseShfcmVmLFt0aGlzXS5jb25jYXQoYXJncykpKSxfdGhpcyksX3RoaXMuc3RhdGU9e2FjdGl2ZUNoaWxkSW5kZXg6X3RoaXMucHJvcHMuZGVmYXVsdEFjdGl2ZUNoaWxkSW5kZXgsY2hpbGRyZW46W119LF90aGlzLmhhbmRsZUtleURvd249ZnVuY3Rpb24oZXZlbnQpe3N3aXRjaChldmVudC5rZXkpe2Nhc2UnQXJyb3dVcCc6aWYoX3RoaXMucHJvcHMubW9kZT09PUFycm93S2V5TmF2aWdhdGlvbi5tb2RlLlZFUlRJQ0FMfHxfdGhpcy5wcm9wcy5tb2RlPT09QXJyb3dLZXlOYXZpZ2F0aW9uLm1vZGUuQk9USCl7ZXZlbnQucHJldmVudERlZmF1bHQoKTtfdGhpcy5tb3ZlRm9jdXMoLTEpO31icmVhaztjYXNlJ0Fycm93TGVmdCc6aWYoX3RoaXMucHJvcHMubW9kZT09PUFycm93S2V5TmF2aWdhdGlvbi5tb2RlLkhPUklaT05UQUx8fF90aGlzLnByb3BzLm1vZGU9PT1BcnJvd0tleU5hdmlnYXRpb24ubW9kZS5CT1RIKXtldmVudC5wcmV2ZW50RGVmYXVsdCgpO190aGlzLm1vdmVGb2N1cygtMSk7fWJyZWFrO2Nhc2UnQXJyb3dEb3duJzppZihfdGhpcy5wcm9wcy5tb2RlPT09QXJyb3dLZXlOYXZpZ2F0aW9uLm1vZGUuVkVSVElDQUx8fF90aGlzLnByb3BzLm1vZGU9PT1BcnJvd0tleU5hdmlnYXRpb24ubW9kZS5CT1RIKXtldmVudC5wcmV2ZW50RGVmYXVsdCgpO190aGlzLm1vdmVGb2N1cygxKTt9YnJlYWs7Y2FzZSdBcnJvd1JpZ2h0JzppZihfdGhpcy5wcm9wcy5tb2RlPT09QXJyb3dLZXlOYXZpZ2F0aW9uLm1vZGUuSE9SSVpPTlRBTHx8X3RoaXMucHJvcHMubW9kZT09PUFycm93S2V5TmF2aWdhdGlvbi5tb2RlLkJPVEgpe2V2ZW50LnByZXZlbnREZWZhdWx0KCk7X3RoaXMubW92ZUZvY3VzKDEpO31icmVhazt9aWYoX3RoaXMucHJvcHMub25LZXlEb3duKXtfdGhpcy5wcm9wcy5vbktleURvd24oZXZlbnQpO319LF90aGlzLmhhbmRsZUZvY3VzPWZ1bmN0aW9uKGV2ZW50KXtpZihldmVudC50YXJnZXQuaGFzQXR0cmlidXRlKERBVEFfQVRUUklCVVRFX0lOREVYKSl7dmFyIGluZGV4PXBhcnNlSW50KGV2ZW50LnRhcmdldC5nZXRBdHRyaWJ1dGUoREFUQV9BVFRSSUJVVEVfSU5ERVgpLDEwKTt2YXIgY2hpbGQ9X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX3JlYWN0X19bXCJDaGlsZHJlblwiXS50b0FycmF5KF90aGlzLnN0YXRlLmNoaWxkcmVuKVtpbmRleF07X3RoaXMuc2V0U3RhdGUoe2FjdGl2ZUNoaWxkSW5kZXg6aW5kZXh9KTtpZihjaGlsZC5wcm9wcy5vbkZvY3VzKXtjaGlsZC5wcm9wcy5vbkZvY3VzKGV2ZW50KTt9fX0sX3RoaXMucGVyc2lzdFdyYXBwZXJFbGVtZW50UmVmZXJlbmNlPWZ1bmN0aW9uKHVua25vd25UeXBlKXtfdGhpcy4kd3JhcHBlcj11bmtub3duVHlwZSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50P3Vua25vd25UeXBlOl9fd2VicGFja19yZXF1aXJlX18uaShfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfcmVhY3RfZG9tX19bXCJmaW5kRE9NTm9kZVwiXSkodW5rbm93blR5cGUpO30sX3RlbXApLF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKF90aGlzLF9yZXQpO31fY3JlYXRlQ2xhc3MoQXJyb3dLZXlOYXZpZ2F0aW9uLFt7a2V5OidnZXRGaWx0ZXJlZENoaWxkcmVuJyx2YWx1ZTpmdW5jdGlvbiBnZXRGaWx0ZXJlZENoaWxkcmVuKCl7dmFyIHByb3BzPWFyZ3VtZW50cy5sZW5ndGg+MCYmYXJndW1lbnRzWzBdIT09dW5kZWZpbmVkP2FyZ3VtZW50c1swXTp0aGlzLnByb3BzO3JldHVybiBfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfcmVhY3RfX1tcIkNoaWxkcmVuXCJdLnRvQXJyYXkocHJvcHMuY2hpbGRyZW4pLmZpbHRlcihCb29sZWFuKTt9fSx7a2V5OidzZXRBY3RpdmVDaGlsZEluZGV4Jyx2YWx1ZTpmdW5jdGlvbiBzZXRBY3RpdmVDaGlsZEluZGV4KCl7aWYodGhpcy5zdGF0ZS5hY3RpdmVDaGlsZEluZGV4IT09MCl7dmFyIG51bUNoaWxkcmVuPV9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9yZWFjdF9fW1wiQ2hpbGRyZW5cIl0uY291bnQodGhpcy5zdGF0ZS5jaGlsZHJlbik7aWYobnVtQ2hpbGRyZW49PT0wKXt0aGlzLnNldFN0YXRlKHthY3RpdmVDaGlsZEluZGV4OjB9KTt9ZWxzZSBpZih0aGlzLnN0YXRlLmFjdGl2ZUNoaWxkSW5kZXg+PW51bUNoaWxkcmVuKXt0aGlzLnNldFN0YXRlKHthY3RpdmVDaGlsZEluZGV4Om51bUNoaWxkcmVuLTF9KTt9fX19LHtrZXk6J2NvbXBvbmVudFdpbGxNb3VudCcsdmFsdWU6ZnVuY3Rpb24gY29tcG9uZW50V2lsbE1vdW50KCl7dGhpcy5zZXRTdGF0ZSh7Y2hpbGRyZW46dGhpcy5nZXRGaWx0ZXJlZENoaWxkcmVuKCl9KTt9fSx7a2V5Oidjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzJyx2YWx1ZTpmdW5jdGlvbiBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5leHRQcm9wcyl7aWYobmV4dFByb3BzLmNoaWxkcmVuIT09dGhpcy5wcm9wcy5jaGlsZHJlbil7cmV0dXJuIHRoaXMuc2V0U3RhdGUoe2NoaWxkcmVuOnRoaXMuZ2V0RmlsdGVyZWRDaGlsZHJlbihuZXh0UHJvcHMpfSx0aGlzLnNldEFjdGl2ZUNoaWxkSW5kZXgpO310aGlzLnNldEFjdGl2ZUNoaWxkSW5kZXgoKTt9fSx7a2V5Oidjb21wb25lbnREaWRVcGRhdGUnLHZhbHVlOmZ1bmN0aW9uIGNvbXBvbmVudERpZFVwZGF0ZShwcmV2UHJvcHMscHJldlN0YXRlKXtpZih0aGlzLnN0YXRlLmFjdGl2ZUNoaWxkSW5kZXghPT1wcmV2U3RhdGUuYWN0aXZlQ2hpbGRJbmRleCl7dGhpcy5zZXRGb2N1cyh0aGlzLnN0YXRlLmFjdGl2ZUNoaWxkSW5kZXgpO319fSx7a2V5OidzZXRGb2N1cycsdmFsdWU6ZnVuY3Rpb24gc2V0Rm9jdXMoaW5kZXgpe3ZhciBjaGlsZE5vZGU9dGhpcy4kd3JhcHBlci5jaGlsZHJlbltpbmRleF07aWYoY2hpbGROb2RlJiZjaGlsZE5vZGUuaGFzQXR0cmlidXRlKERBVEFfQVRUUklCVVRFX1NLSVApKXt0aGlzLm1vdmVGb2N1cyhjaGlsZE5vZGUuY29tcGFyZURvY3VtZW50UG9zaXRpb24oZG9jdW1lbnQuYWN0aXZlRWxlbWVudCkmTm9kZS5ET0NVTUVOVF9QT1NJVElPTl9GT0xMT1dJTkc/LTE6MSk7fWVsc2UgaWYoY2hpbGROb2RlJiZkb2N1bWVudC5hY3RpdmVFbGVtZW50IT09Y2hpbGROb2RlKXtjaGlsZE5vZGUuZm9jdXMoKTt9fX0se2tleTonbW92ZUZvY3VzJyx2YWx1ZTpmdW5jdGlvbiBtb3ZlRm9jdXMoZGVsdGEpe3ZhciBudW1DaGlsZHJlbj10aGlzLnN0YXRlLmNoaWxkcmVuP19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9yZWFjdF9fW1wiQ2hpbGRyZW5cIl0uY291bnQodGhpcy5zdGF0ZS5jaGlsZHJlbik6MDt2YXIgbmV4dEluZGV4PXRoaXMuc3RhdGUuYWN0aXZlQ2hpbGRJbmRleCtkZWx0YTtpZihuZXh0SW5kZXg+PW51bUNoaWxkcmVuKXtuZXh0SW5kZXg9MDt9ZWxzZSBpZihuZXh0SW5kZXg8MCl7bmV4dEluZGV4PW51bUNoaWxkcmVuLTE7fXRoaXMuc2V0U3RhdGUoe2FjdGl2ZUNoaWxkSW5kZXg6bmV4dEluZGV4fSk7fX0se2tleToncmVuZGVyQ2hpbGRyZW4nLHZhbHVlOmZ1bmN0aW9uIHJlbmRlckNoaWxkcmVuKCl7dmFyIF90aGlzMj10aGlzO3JldHVybiBfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfcmVhY3RfX1tcIkNoaWxkcmVuXCJdLm1hcCh0aGlzLnN0YXRlLmNoaWxkcmVuLGZ1bmN0aW9uKGNoaWxkLGluZGV4KXt2YXIgX1JlYWN0JGNsb25lRWxlbWVudDtyZXR1cm4gX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX3JlYWN0X19fZGVmYXVsdC5hLmNsb25lRWxlbWVudChjaGlsZCwoX1JlYWN0JGNsb25lRWxlbWVudD17fSxfZGVmaW5lUHJvcGVydHkoX1JlYWN0JGNsb25lRWxlbWVudCxEQVRBX0FUVFJJQlVURV9JTkRFWCxpbmRleCksX2RlZmluZVByb3BlcnR5KF9SZWFjdCRjbG9uZUVsZW1lbnQsREFUQV9BVFRSSUJVVEVfU0tJUCxwYXJzZUludChjaGlsZC5wcm9wcy50YWJJbmRleCwxMCk9PT0tMXx8dW5kZWZpbmVkKSxfZGVmaW5lUHJvcGVydHkoX1JlYWN0JGNsb25lRWxlbWVudCwna2V5JyxjaGlsZC5rZXl8fGluZGV4KSxfZGVmaW5lUHJvcGVydHkoX1JlYWN0JGNsb25lRWxlbWVudCwndGFiSW5kZXgnLF90aGlzMi5zdGF0ZS5hY3RpdmVDaGlsZEluZGV4PT09aW5kZXg/MDotMSksX1JlYWN0JGNsb25lRWxlbWVudCkpO30pO319LHtrZXk6J3JlbmRlcicsdmFsdWU6ZnVuY3Rpb24gcmVuZGVyKCl7cmV0dXJuIF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9yZWFjdF9fX2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KHRoaXMucHJvcHMuY29tcG9uZW50LF9leHRlbmRzKHt9LF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9ib3VuZGxlc3NfdXRpbHNfb21pdF9rZXlzX19fZGVmYXVsdCgpKHRoaXMucHJvcHMsQXJyb3dLZXlOYXZpZ2F0aW9uLmludGVybmFsS2V5cykse3JlZjp0aGlzLnBlcnNpc3RXcmFwcGVyRWxlbWVudFJlZmVyZW5jZSxvbkZvY3VzOnRoaXMuaGFuZGxlRm9jdXMsb25LZXlEb3duOnRoaXMuaGFuZGxlS2V5RG93bn0pLHRoaXMucmVuZGVyQ2hpbGRyZW4oKSk7fX1dKTtyZXR1cm4gQXJyb3dLZXlOYXZpZ2F0aW9uO30oX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX3JlYWN0X19fZGVmYXVsdC5hLlB1cmVDb21wb25lbnQpO0Fycm93S2V5TmF2aWdhdGlvbi5tb2RlPXtIT1JJWk9OVEFMOl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfM19ib3VuZGxlc3NfdXRpbHNfdXVpZF9fX2RlZmF1bHQoKSgpLFZFUlRJQ0FMOl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfM19ib3VuZGxlc3NfdXRpbHNfdXVpZF9fX2RlZmF1bHQoKSgpLEJPVEg6X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8zX2JvdW5kbGVzc191dGlsc191dWlkX19fZGVmYXVsdCgpKCl9O0Fycm93S2V5TmF2aWdhdGlvbi5wcm9wVHlwZXM9eycqJzpfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfcmVhY3RfX1tcIlByb3BUeXBlc1wiXS5hbnksY29tcG9uZW50Ol9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9yZWFjdF9fW1wiUHJvcFR5cGVzXCJdLm9uZU9mVHlwZShbX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX3JlYWN0X19bXCJQcm9wVHlwZXNcIl0uc3RyaW5nLF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9yZWFjdF9fW1wiUHJvcFR5cGVzXCJdLmZ1bmNdKSxkZWZhdWx0QWN0aXZlQ2hpbGRJbmRleDpfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfcmVhY3RfX1tcIlByb3BUeXBlc1wiXS5udW1iZXIsbW9kZTpfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfcmVhY3RfX1tcIlByb3BUeXBlc1wiXS5vbmVPZihbQXJyb3dLZXlOYXZpZ2F0aW9uLm1vZGUuQk9USCxBcnJvd0tleU5hdmlnYXRpb24ubW9kZS5IT1JJWk9OVEFMLEFycm93S2V5TmF2aWdhdGlvbi5tb2RlLlZFUlRJQ0FMXSl9O0Fycm93S2V5TmF2aWdhdGlvbi5kZWZhdWx0UHJvcHM9e2NvbXBvbmVudDonZGl2JyxkZWZhdWx0QWN0aXZlQ2hpbGRJbmRleDowLG1vZGU6QXJyb3dLZXlOYXZpZ2F0aW9uLm1vZGUuQk9USCxvbktleURvd246ZnVuY3Rpb24gb25LZXlEb3duKCl7fX07QXJyb3dLZXlOYXZpZ2F0aW9uLmludGVybmFsS2V5cz1PYmplY3Qua2V5cyhBcnJvd0tleU5hdmlnYXRpb24uZGVmYXVsdFByb3BzKTsvKiBoYXJtb255IGRlZmF1bHQgZXhwb3J0ICovIF9fd2VicGFja19leHBvcnRzX19bXCJkZWZhdWx0XCJdID0gQXJyb3dLZXlOYXZpZ2F0aW9uO1xuXG4vKioqLyB9KVxuLyoqKioqKi8gXSk7XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGluZGV4LmpzIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG5cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGlkZW50aXR5IGZ1bmN0aW9uIGZvciBjYWxsaW5nIGhhcm1vbnkgaW1wb3J0cyB3aXRoIHRoZSBjb3JyZWN0IGNvbnRleHRcbiBcdF9fd2VicGFja19yZXF1aXJlX18uaSA9IGZ1bmN0aW9uKHZhbHVlKSB7IHJldHVybiB2YWx1ZTsgfTtcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7XG4gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbiBcdFx0XHRcdGdldDogZ2V0dGVyXG4gXHRcdFx0fSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gNCk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd2VicGFjay9ib290c3RyYXAgYjY5ZTJlZjViNTkyNjRmMDI2MzkiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJib3VuZGxlc3MtdXRpbHMtb21pdC1rZXlzXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIHtcImNvbW1vbmpzMlwiOlwiYm91bmRsZXNzLXV0aWxzLW9taXQta2V5c1wifVxuLy8gbW9kdWxlIGlkID0gMFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJib3VuZGxlc3MtdXRpbHMtdXVpZFwiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCB7XCJjb21tb25qczJcIjpcImJvdW5kbGVzcy11dGlscy11dWlkXCJ9XG4vLyBtb2R1bGUgaWQgPSAxXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInJlYWN0XCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIHtcImNvbW1vbmpzMlwiOlwicmVhY3RcIn1cbi8vIG1vZHVsZSBpZCA9IDJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwicmVhY3QtZG9tXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIHtcImNvbW1vbmpzMlwiOlwicmVhY3QtZG9tXCJ9XG4vLyBtb2R1bGUgaWQgPSAzXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCBSZWFjdCwge0NoaWxkcmVuLCBQcm9wVHlwZXN9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7ZmluZERPTU5vZGV9IGZyb20gJ3JlYWN0LWRvbSc7XG5cbmltcG9ydCBvbWl0IGZyb20gJ2JvdW5kbGVzcy11dGlscy1vbWl0LWtleXMnO1xuaW1wb3J0IHV1aWQgZnJvbSAnYm91bmRsZXNzLXV0aWxzLXV1aWQnO1xuXG5jb25zdCBEQVRBX0FUVFJJQlVURV9JTkRFWCA9ICdkYXRhLWZvY3VzLWluZGV4JztcbmNvbnN0IERBVEFfQVRUUklCVVRFX1NLSVAgPSAnZGF0YS1mb2N1cy1za2lwJztcblxuLyoqXG5BcnJvd0tleU5hdmlnYXRpb24gaXMgZGVzaWduZWQgbm90IHRvIGNhcmUgYWJvdXQgdGhlIGNvbXBvbmVudCB0eXBlcyBpdCBpcyB3cmFwcGluZy4gRHVlIHRvIHRoaXMsIHlvdSBjYW4gcGFzcyB3aGF0ZXZlciBIVE1MIHRhZyB5b3UgbGlrZSBpbnRvIGBwcm9wcy5jb21wb25lbnRgIG9yIGV2ZW4gYSBSZWFjdCBjb21wb25lbnQgeW91J3ZlIG1hZGUgZWxzZXdoZXJlLiBBZGRpdGlvbmFsIHByb3BzIHBhc3NlZCB0byBgPEFycm93S2V5TmF2aWdhdGlvbiAuLi4+YCB3aWxsIGJlIGZvcndhcmRlZCBvbiB0byB0aGUgY29tcG9uZW50IG9yIEhUTUwgdGFnIG5hbWUgeW91J3ZlIHN1cHBsaWVkLlxuXG5UaGUgY2hpbGRyZW4sIHNpbWlsYXJseSwgY2FuIGJlIGFueSB0eXBlIG9mIGNvbXBvbmVudC5cbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXJyb3dLZXlOYXZpZ2F0aW9uIGV4dGVuZHMgUmVhY3QuUHVyZUNvbXBvbmVudCB7XG4gICAgc3RhdGljIG1vZGUgPSB7XG4gICAgICAgIEhPUklaT05UQUw6IHV1aWQoKSxcbiAgICAgICAgVkVSVElDQUw6IHV1aWQoKSxcbiAgICAgICAgQk9USDogdXVpZCgpLFxuICAgIH1cblxuICAgIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBhbnkgW1JlYWN0LXN1cHBvcnRlZCBhdHRyaWJ1dGVdKGh0dHBzOi8vZmFjZWJvb2suZ2l0aHViLmlvL3JlYWN0L2RvY3MvdGFncy1hbmQtYXR0cmlidXRlcy5odG1sI2h0bWwtYXR0cmlidXRlcylcbiAgICAgICAgICovXG4gICAgICAgICcqJzogUHJvcFR5cGVzLmFueSxcblxuICAgICAgICAvKipcbiAgICAgICAgICAgIEFueSB2YWxpZCBIVE1MIHRhZyBuYW1lIG9yIGEgUmVhY3QgY29tcG9uZW50IGZhY3RvcnksIGFueXRoaW5nIHRoYXQgY2FuIGJlIHBhc3NlZCBhcyB0aGUgZmlyc3QgYXJndW1lbnQgdG8gYFJlYWN0LmNyZWF0ZUVsZW1lbnRgXG4gICAgICAgICovXG4gICAgICAgIGNvbXBvbmVudDogUHJvcFR5cGVzLm9uZU9mVHlwZShbXG4gICAgICAgICAgICBQcm9wVHlwZXMuc3RyaW5nLFxuICAgICAgICAgICAgUHJvcFR5cGVzLmZ1bmMsXG4gICAgICAgIF0pLFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgICAgQWxsb3dzIGZvciBhIHBhcnRpY3VsYXIgY2hpbGQgdG8gYmUgaW5pdGlhbGx5IHJlYWNoYWJsZSB2aWEgdGFiYmluZzsgb25seSBhcHBsaWVkIGR1cmluZyBmaXJzdCByZW5kZXJcbiAgICAgICAgKi9cbiAgICAgICAgZGVmYXVsdEFjdGl2ZUNoaWxkSW5kZXg6IFByb3BUeXBlcy5udW1iZXIsXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIGNvbnRyb2xzIHdoaWNoIGFycm93IGtleSBldmVudHMgYXJlIGNhcHR1cmVkIHRvIG1vdmUgYWN0aXZlIGZvY3VzIHdpdGhpbiB0aGUgbGlzdDpcbiAgICAgICAgICpcbiAgICAgICAgICogTW9kZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgS2V5c1xuICAgICAgICAgKiAtLS0tICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAtLS0tXG4gICAgICAgICAqIGBBcnJvd0tleU5hdmlnYXRpb24ubW9kZS5CT1RIYCAgICAgICB8IOKshe+4jyDinqHvuI8g4qyG77iPIOKsh++4j1xuICAgICAgICAgKiBgQXJyb3dLZXlOYXZpZ2F0aW9uLm1vZGUuSE9SSVpPTlRBTGAgfCDirIXvuI8g4p6h77iPXG4gICAgICAgICAqIGBBcnJvd0tleU5hdmlnYXRpb24ubW9kZS5WRVJUSUNBTGAgICB8IOKshu+4jyDirIfvuI9cbiAgICAgICAgICpcbiAgICAgICAgICogX05vdGU6IGZvY3VzIGxvb3BzIHdoZW4gYXJyb3dpbmcgcGFzdCBvbmUgb2YgdGhlIGJvdW5kYXJpZXM7IHRhYmJpbmcgbW92ZXMgdGhlIHVzZXIgYXdheSBmcm9tIHRoZSBsaXN0Ll9cbiAgICAgICAgKi9cbiAgICAgICAgbW9kZTogUHJvcFR5cGVzLm9uZU9mKFtcbiAgICAgICAgICAgIEFycm93S2V5TmF2aWdhdGlvbi5tb2RlLkJPVEgsXG4gICAgICAgICAgICBBcnJvd0tleU5hdmlnYXRpb24ubW9kZS5IT1JJWk9OVEFMLFxuICAgICAgICAgICAgQXJyb3dLZXlOYXZpZ2F0aW9uLm1vZGUuVkVSVElDQUwsXG4gICAgICAgIF0pLFxuICAgIH1cblxuICAgIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XG4gICAgICAgIGNvbXBvbmVudDogJ2RpdicsXG4gICAgICAgIGRlZmF1bHRBY3RpdmVDaGlsZEluZGV4OiAwLFxuICAgICAgICBtb2RlOiBBcnJvd0tleU5hdmlnYXRpb24ubW9kZS5CT1RILFxuICAgICAgICBvbktleURvd246ICgpID0+IHt9LFxuICAgIH1cblxuICAgIHN0YXRpYyBpbnRlcm5hbEtleXMgPSBPYmplY3Qua2V5cyhBcnJvd0tleU5hdmlnYXRpb24uZGVmYXVsdFByb3BzKVxuXG4gICAgc3RhdGUgPSB7XG4gICAgICAgIGFjdGl2ZUNoaWxkSW5kZXg6IHRoaXMucHJvcHMuZGVmYXVsdEFjdGl2ZUNoaWxkSW5kZXgsXG4gICAgICAgIGNoaWxkcmVuOiBbXSxcbiAgICB9XG5cbiAgICBnZXRGaWx0ZXJlZENoaWxkcmVuKHByb3BzID0gdGhpcy5wcm9wcykge1xuICAgICAgICByZXR1cm4gQ2hpbGRyZW4udG9BcnJheShwcm9wcy5jaGlsZHJlbikuZmlsdGVyKEJvb2xlYW4pO1xuICAgIH1cblxuICAgIHNldEFjdGl2ZUNoaWxkSW5kZXgoKSB7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmFjdGl2ZUNoaWxkSW5kZXggIT09IDApIHtcbiAgICAgICAgICAgIGNvbnN0IG51bUNoaWxkcmVuID0gQ2hpbGRyZW4uY291bnQodGhpcy5zdGF0ZS5jaGlsZHJlbik7XG5cbiAgICAgICAgICAgIGlmIChudW1DaGlsZHJlbiA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe2FjdGl2ZUNoaWxkSW5kZXg6IDB9KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5zdGF0ZS5hY3RpdmVDaGlsZEluZGV4ID49IG51bUNoaWxkcmVuKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7YWN0aXZlQ2hpbGRJbmRleDogbnVtQ2hpbGRyZW4gLSAxfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb21wb25lbnRXaWxsTW91bnQoKSB7IHRoaXMuc2V0U3RhdGUoe2NoaWxkcmVuOiB0aGlzLmdldEZpbHRlcmVkQ2hpbGRyZW4oKX0pOyB9XG5cbiAgICBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5leHRQcm9wcykge1xuICAgICAgICBpZiAobmV4dFByb3BzLmNoaWxkcmVuICE9PSB0aGlzLnByb3BzLmNoaWxkcmVuKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zZXRTdGF0ZSh7Y2hpbGRyZW46IHRoaXMuZ2V0RmlsdGVyZWRDaGlsZHJlbihuZXh0UHJvcHMpfSwgdGhpcy5zZXRBY3RpdmVDaGlsZEluZGV4KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc2V0QWN0aXZlQ2hpbGRJbmRleCgpO1xuICAgIH1cblxuICAgIGNvbXBvbmVudERpZFVwZGF0ZShwcmV2UHJvcHMsIHByZXZTdGF0ZSkge1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS5hY3RpdmVDaGlsZEluZGV4ICE9PSBwcmV2U3RhdGUuYWN0aXZlQ2hpbGRJbmRleCkge1xuICAgICAgICAgICAgdGhpcy5zZXRGb2N1cyh0aGlzLnN0YXRlLmFjdGl2ZUNoaWxkSW5kZXgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgc2V0Rm9jdXMoaW5kZXgpIHtcbiAgICAgICAgY29uc3QgY2hpbGROb2RlID0gdGhpcy4kd3JhcHBlci5jaGlsZHJlbltpbmRleF07XG5cbiAgICAgICAgaWYgKGNoaWxkTm9kZSAmJiBjaGlsZE5vZGUuaGFzQXR0cmlidXRlKERBVEFfQVRUUklCVVRFX1NLSVApKSB7XG4gICAgICAgICAgICB0aGlzLm1vdmVGb2N1cyhcbiAgICAgICAgICAgICAgICBjaGlsZE5vZGUuY29tcGFyZURvY3VtZW50UG9zaXRpb24oZG9jdW1lbnQuYWN0aXZlRWxlbWVudCkgJiBOb2RlLkRPQ1VNRU5UX1BPU0lUSU9OX0ZPTExPV0lORyA/IC0xIDogMVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIGlmIChjaGlsZE5vZGUgJiYgZG9jdW1lbnQuYWN0aXZlRWxlbWVudCAhPT0gY2hpbGROb2RlKSB7XG4gICAgICAgICAgICBjaGlsZE5vZGUuZm9jdXMoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG1vdmVGb2N1cyhkZWx0YSkge1xuICAgICAgICBjb25zdCBudW1DaGlsZHJlbiA9IHRoaXMuc3RhdGUuY2hpbGRyZW4gPyBDaGlsZHJlbi5jb3VudCh0aGlzLnN0YXRlLmNoaWxkcmVuKSA6IDA7XG4gICAgICAgIGxldCBuZXh0SW5kZXggPSB0aGlzLnN0YXRlLmFjdGl2ZUNoaWxkSW5kZXggKyBkZWx0YTtcblxuICAgICAgICBpZiAobmV4dEluZGV4ID49IG51bUNoaWxkcmVuKSB7XG4gICAgICAgICAgICBuZXh0SW5kZXggPSAwOyAvLyBsb29wXG4gICAgICAgIH0gZWxzZSBpZiAobmV4dEluZGV4IDwgMCkge1xuICAgICAgICAgICAgbmV4dEluZGV4ID0gbnVtQ2hpbGRyZW4gLSAxOyAvLyByZXZlcnNlIGxvb3BcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe2FjdGl2ZUNoaWxkSW5kZXg6IG5leHRJbmRleH0pO1xuICAgIH1cblxuICAgIGhhbmRsZUtleURvd24gPSAoZXZlbnQpID0+IHtcbiAgICAgICAgc3dpdGNoIChldmVudC5rZXkpIHtcbiAgICAgICAgY2FzZSAnQXJyb3dVcCc6XG4gICAgICAgICAgICBpZiAodGhpcy5wcm9wcy5tb2RlID09PSBBcnJvd0tleU5hdmlnYXRpb24ubW9kZS5WRVJUSUNBTFxuICAgICAgICAgICAgICAgIHx8IHRoaXMucHJvcHMubW9kZSA9PT0gQXJyb3dLZXlOYXZpZ2F0aW9uLm1vZGUuQk9USCkge1xuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5tb3ZlRm9jdXMoLTEpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdBcnJvd0xlZnQnOlxuICAgICAgICAgICAgaWYgKHRoaXMucHJvcHMubW9kZSA9PT0gQXJyb3dLZXlOYXZpZ2F0aW9uLm1vZGUuSE9SSVpPTlRBTFxuICAgICAgICAgICAgICAgIHx8IHRoaXMucHJvcHMubW9kZSA9PT0gQXJyb3dLZXlOYXZpZ2F0aW9uLm1vZGUuQk9USCkge1xuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5tb3ZlRm9jdXMoLTEpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdBcnJvd0Rvd24nOlxuICAgICAgICAgICAgaWYgKHRoaXMucHJvcHMubW9kZSA9PT0gQXJyb3dLZXlOYXZpZ2F0aW9uLm1vZGUuVkVSVElDQUxcbiAgICAgICAgICAgICAgICB8fCB0aGlzLnByb3BzLm1vZGUgPT09IEFycm93S2V5TmF2aWdhdGlvbi5tb2RlLkJPVEgpIHtcbiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHRoaXMubW92ZUZvY3VzKDEpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdBcnJvd1JpZ2h0JzpcbiAgICAgICAgICAgIGlmICh0aGlzLnByb3BzLm1vZGUgPT09IEFycm93S2V5TmF2aWdhdGlvbi5tb2RlLkhPUklaT05UQUxcbiAgICAgICAgICAgICAgICB8fCB0aGlzLnByb3BzLm1vZGUgPT09IEFycm93S2V5TmF2aWdhdGlvbi5tb2RlLkJPVEgpIHtcbiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHRoaXMubW92ZUZvY3VzKDEpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnByb3BzLm9uS2V5RG93bikge1xuICAgICAgICAgICAgdGhpcy5wcm9wcy5vbktleURvd24oZXZlbnQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaGFuZGxlRm9jdXMgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5oYXNBdHRyaWJ1dGUoREFUQV9BVFRSSUJVVEVfSU5ERVgpKSB7XG4gICAgICAgICAgICBjb25zdCBpbmRleCA9IHBhcnNlSW50KGV2ZW50LnRhcmdldC5nZXRBdHRyaWJ1dGUoREFUQV9BVFRSSUJVVEVfSU5ERVgpLCAxMCk7XG4gICAgICAgICAgICBjb25zdCBjaGlsZCA9IENoaWxkcmVuLnRvQXJyYXkodGhpcy5zdGF0ZS5jaGlsZHJlbilbaW5kZXhdO1xuXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHthY3RpdmVDaGlsZEluZGV4OiBpbmRleH0pO1xuXG4gICAgICAgICAgICBpZiAoY2hpbGQucHJvcHMub25Gb2N1cykge1xuICAgICAgICAgICAgICAgIGNoaWxkLnByb3BzLm9uRm9jdXMoZXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmVuZGVyQ2hpbGRyZW4oKSB7XG4gICAgICAgIHJldHVybiBDaGlsZHJlbi5tYXAodGhpcy5zdGF0ZS5jaGlsZHJlbiwgKGNoaWxkLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIFJlYWN0LmNsb25lRWxlbWVudChjaGlsZCwge1xuICAgICAgICAgICAgICAgIFtEQVRBX0FUVFJJQlVURV9JTkRFWF06IGluZGV4LFxuICAgICAgICAgICAgICAgIFtEQVRBX0FUVFJJQlVURV9TS0lQXTogcGFyc2VJbnQoY2hpbGQucHJvcHMudGFiSW5kZXgsIDEwKSA9PT0gLTEgfHwgdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIGtleTogY2hpbGQua2V5IHx8IGluZGV4LFxuICAgICAgICAgICAgICAgIHRhYkluZGV4OiB0aGlzLnN0YXRlLmFjdGl2ZUNoaWxkSW5kZXggPT09IGluZGV4ID8gMCA6IC0xLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHBlcnNpc3RXcmFwcGVyRWxlbWVudFJlZmVyZW5jZSA9ICh1bmtub3duVHlwZSkgPT4ge1xuICAgICAgICB0aGlzLiR3cmFwcGVyID0gdW5rbm93blR5cGUgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCA/IHVua25vd25UeXBlIDogZmluZERPTU5vZGUodW5rbm93blR5cGUpO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDx0aGlzLnByb3BzLmNvbXBvbmVudFxuICAgICAgICAgICAgICAgIHsuLi5vbWl0KHRoaXMucHJvcHMsIEFycm93S2V5TmF2aWdhdGlvbi5pbnRlcm5hbEtleXMpfVxuICAgICAgICAgICAgICAgIHJlZj17dGhpcy5wZXJzaXN0V3JhcHBlckVsZW1lbnRSZWZlcmVuY2V9XG4gICAgICAgICAgICAgICAgb25Gb2N1cz17dGhpcy5oYW5kbGVGb2N1c31cbiAgICAgICAgICAgICAgICBvbktleURvd249e3RoaXMuaGFuZGxlS2V5RG93bn0+XG4gICAgICAgICAgICAgICAge3RoaXMucmVuZGVyQ2hpbGRyZW4oKX1cbiAgICAgICAgICAgIDwvdGhpcy5wcm9wcy5jb21wb25lbnQ+XG4gICAgICAgICk7XG4gICAgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vcGFja2FnZXMvYm91bmRsZXNzLWFycm93LWtleS1uYXZpZ2F0aW9uL2luZGV4LmpzIl0sInNvdXJjZVJvb3QiOiIifQ==